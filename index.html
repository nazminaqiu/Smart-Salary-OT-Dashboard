<!DOCTYPE html>
<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Salary &amp; OT Dashboard
  </title>
  <link href="https://fonts.googleapis.com" rel="preconnect"/>
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js">
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr">
  </script>
  <script type="module" src="main.js"></script>
  <link href="css/style.css" rel="stylesheet"/>
 </head>
 <body>
  <div class="wrap">
   <header>
    <div class="row">
     <h1>
      Salary &amp; OT Dashboard
     </h1>
     <select id="monthSelect">
     </select>
    </div>
    <div class="row">
     <button class="btn ghost" id="generatePayslipBtn">
      Generate Payslip
     </button>
     <button class="btn ghost" id="viewAnnualSummaryBtn">
      View Annual Summary
     </button>
     <button class="btn ghost" id="exportData">
      Export Data
     </button>
     <button class="btn ghost" id="importData">
      Import Data
     </button>
     <button class="btn ghost" id="resetAll">
      Reset data
     </button>
    </div>
   </header>
   <div class="tabs">
    <button class="tab active" onclick="switchTab('manual', this)">
     Manual Tracking
    </button>
    <button class="tab" onclick="switchTab('smart', this)">
     Smart Calculator
    </button>
    <button class="tab" onclick="switchTab('expenses', this)">
     Monthly Expenses
    </button>
    <button class="tab" onclick="switchTab('forecast', this)">
     Forecast
    </button>
   </div>
   <div class="tab-content active" id="manual-tab">
    <div class="grid grid-2">
     <div class="card panel">
      <h2 class="section-title">
       ‚öôÔ∏è Settings
      </h2>
      <div class="deduction-mode-toggle">
       <button id="deductionModeEstimate" onclick="setDeductionMode('estimate')">
        Estimate (%)
       </button>
       <button class="active" id="deductionModeActual" onclick="setDeductionMode('actual')">
        Actual (RM)
       </button>
      </div>
      <div class="grid grid-2" style="margin-top: 16px; border-top: 1px solid var(--border); padding-top: 16px;">
       <div>
        <label for="payPeriodStart">
         Pay Period Start Date
        </label>
        <input id="payPeriodStart" type="text"/>
       </div>
       <div>
        <label for="payPeriodEnd">
         Pay Period End Date
        </label>
        <input id="payPeriodEnd" type="text"/>
       </div>
      </div>
      <div style="margin-top: 20px;">
        <div class="grid grid-2" style="align-items: start;">
            <div class="form-section" style="padding: 20px; margin: 0; height: 100%;">
             <h4 style="margin-top:0; margin-bottom: 20px;">
              üí∞ Income Components
             </h4>
             <div class="input-wrapper">
              <label for="basic">
               üíµ Basic Salary (RM)
              </label>
              <div class="input-with-adjuster">
               <input id="basic" step="0.01" type="number"/>
               <div class="input-adjuster-buttons">
                <button class="adjust-btn" data-amount="10" data-target="basic" type="button">
                 ‚ñ≤
                </button>
                <button class="adjust-btn" data-amount="-10" data-target="basic" type="button">
                 ‚ñº
                </button>
               </div>
              </div>
             </div>
             <div class="input-wrapper">
              <label for="claims">
               üìã Claims (RM)
              </label>
              <div class="input-with-adjuster">
               <input id="claims" step="0.01" type="number"/>
               <div class="input-adjuster-buttons">
                <button class="adjust-btn" data-amount="10" data-target="claims" type="button">
                 ‚ñ≤
                </button>
                <button class="adjust-btn" data-amount="-10" data-target="claims" type="button">
                 ‚ñº
                </button>
               </div>
              </div>
             </div>
             <div class="input-wrapper">
              <label for="hpAllow">
               üì± HP Allowance (RM)
              </label>
              <div class="input-with-adjuster">
               <input id="hpAllow" step="0.01" type="number"/>
               <div class="input-adjuster-buttons">
                <button class="adjust-btn" data-amount="10" data-target="hpAllow" type="button">
                 ‚ñ≤
                </button>
                <button class="adjust-btn" data-amount="-10" data-target="hpAllow" type="button">
                 ‚ñº
                </button>
               </div>
              </div>
             </div>
             <div class="input-wrapper">
              <label for="incentive">
               üéØ Incentive (RM)
              </label>
              <div class="input-with-adjuster">
               <input id="incentive" step="0.01" type="number"/>
               <div class="input-adjuster-buttons">
                <button class="adjust-btn" data-amount="10" data-target="incentive" type="button">
                 ‚ñ≤
                </button>
                <button class="adjust-btn" data-amount="-10" data-target="incentive" type="button">
                 ‚ñº
                </button>
               </div>
              </div>
             </div>
            </div>
            <div class="form-section" style="padding: 20px; margin: 0; height: 100%;">
             <h4 style="margin-top:0; margin-bottom: 20px;">
              üí∏ Deductions
             </h4>
             <div class="grid grid-2" style="gap: 16px;">
              <div>
               <label id="epfLabel">
                üè¶ EPF (%)
               </label>
               <input id="epf" step="0.01" type="number"/>
              </div>
              <div>
               <label id="socsoLabel">
                üõ°Ô∏è SOCSO (%)
               </label>
               <input id="socso" step="0.01" type="number"/>
              </div>
              <div>
               <label id="pcbLabel">
                üìä PCB (%)
               </label>
               <input id="pcb" step="0.01" type="number"/>
              </div>
              <div>
               <label id="eisLabel">
                ‚ö° EIS (%)
               </label>
               <input id="eis" step="0.01" type="number"/>
              </div>
             </div>
             <div style="margin-top: 16px;">
              <label>
               üí∏ Cash Advance (RM)
              </label>
              <input id="advance" step="0.01" type="number"/>
             </div>
             <div style="margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border)">
                <label>
                ‚è∞ Calculated Hourly Rate (RM)
                </label>
                <input id="hourly" readonly="" step="0.0001" type="number"/>
             </div>
            </div>
        </div>
      </div>
      <div class="row" style="margin-top: 28px; justify-content: flex-end">
       <button class="btn ghost" id="copyLastMonth">
        Copy Last Month
       </button>
       <button class="btn primary" id="saveParams">
        Save Settings
       </button>
      </div>
      <div id="saveMessage" style="display: none;">
      </div>
     </div>
     <div class="card panel">
      <h2 class="section-title" style="margin-bottom: 20px">
       üìà Quick Stats
      </h2>
      <div class="grid grid-3">
       <div class="stat">
        <div class="label">
         Gross Income
        </div>
        <div class="value" id="grossOut">
         RM 0.00
        </div>
       </div>
       <div class="stat">
        <div class="label">
         Net Pay
        </div>
        <div class="value" id="netOut" style="color: var(--success)">
         RM 0.00
        </div>
       </div>
       <div class="stat">
        <div class="label">
         Remaining Balance
        </div>
        <div class="value" id="balanceOut" style="color: var(--success)">
         RM 0.00
        </div>
       </div>
      </div>
      <div class="grid grid-2" style="margin-top: 16px;">
       <div class="stat secondary">
        <div class="label">
         Total Deductions
        </div>
        <div class="value" id="deductOut" style="color: var(--warning)">
         RM 0.00
        </div>
       </div>
       <div class="stat secondary">
        <div class="label">
         Total Expenses
        </div>
        <div class="value" id="expensesOut" style="color: var(--danger)">
         RM 0.00
        </div>
       </div>
      </div>
      <div class="form-section goal-setting-section">
        <div class="split" style="margin-bottom: 20px;">
            <h4 style="margin-top:0; margin-bottom: 0;">
            üéØ Goal Setting
            </h4>
            <div class="toggle-group">
            <label class="switch">
                <input id="smartGoalToggle" type="checkbox"/>
                <span class="slider">
                </span>
            </label>
            <label class="toggle-label" for="smartGoalToggle" style="margin-bottom: 0;">
                ‚ú® Smart Goal
            </label>
            </div>
        </div>
        <div class="grid grid-2" style="align-items: start; gap: 24px;">
            <div>
                <div id="desiredSavingsContainer" style="display: none; margin-bottom: 16px;">
                    <label>
                    üè¶ Desired End-of-Month Balance (RM)
                    </label>
                    <input id="desiredSavings" step="0.01" type="number">
                    </input>
                </div>
                <div>
                    <label>
                    üí∞ Net Income Goal (RM)
                    </label>
                    <input id="incomeGoal" step="0.01" type="number"/>
                </div>
            </div>
            <div>
                <div class="what-if-goal-analysis" id="whatIfGoalAnalysis" style="display: none; margin-top: 0;">
                    <h4>
                    üéØ Goal Analysis
                    </h4>
                    <p style="margin-bottom: 4px;">
                    Required Gross OT Pay:
                    </p>
                    <div class="goal-ot-value" id="goalOtValue" style="font-size: 24px; padding-bottom: 10px;">
                     RM 0.00
                    </div>
                </div>
            </div>
        </div>
        <div class="income-goal-visualizer" id="incomeGoalVisualizer" style="margin-top: 16px;">
            <div class="label">
            Progress to Net Income Goal
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" id="progressBarFill">
                </div>
                <div class="progress-bar-text" id="progressBarText">
                </div>
            </div>
            <div class="hours-to-goal-helper" id="hoursToGoalHelper">
            </div>
        </div>
      </div>
      <div class="hour-adjuster-panel" id="manualHourAdjusterContainer" style="display: none; margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border);">
       <h4>
        üîß Fine-Tune Schedule
       </h4>
       <div style="text-align: center; margin-bottom: 16px; font-size: 16px;">
        <span>
         Total OT Pay:
        </span>
        <strong id="manualTotalOtPayAdjuster" style="color: var(--accent); font-size: 18px;">
         RM 0.00
        </strong>
       </div>
       <div class="grid grid-4">
        <div class="adjuster-item">
         <label>
          Weekday (1.5x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustManualHours('weekday', -0.5)">
           -
          </button>
          <input id="manualWeekdayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustManualHours('weekday', 0.5)">
           +
          </button>
         </div>
        </div>
        <div class="adjuster-item">
         <label>
          Saturday (1.5x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustManualHours('saturday', -0.5)">
           -
          </button>
          <input id="manualSaturdayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustManualHours('saturday', 0.5)">
           +
          </button>
         </div>
        </div>
        <div class="adjuster-item">
         <label>
          Sunday (0.5x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustManualHours('sunday', -0.5)">
           -
          </button>
          <input id="manualSundayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustManualHours('sunday', 0.5)">
           +
          </button>
         </div>
        </div>
        <div class="adjuster-item">
         <label>
          Holiday (2.0x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustManualHours('holiday', -0.5)">
           -
          </button>
          <input id="holidayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustManualHours('holiday', 0.5)">
           +
          </button>
         </div>
        </div>
       </div>
      </div>
     </div>
    </div>
    <div class="card panel" style="margin-top: 24px">
     <div class="split">
      <h2 class="section-title">
       ‚è∞ Overtime Sessions (
       <span id="monthLabel">
       </span>
       )
      </h2>
      <div class="row">
       <button class="btn primary" data-day="weekday" data-hours="2" id="quickAddWeekday">
        +2h Weekday
       </button>
       <button class="btn" data-day="saturday" data-hours="4" id="quickAddSat4">
        +4h Saturday
       </button>
       <button class="btn" data-day="saturday" data-hours="8" id="quickAddSat8">
        +8h Saturday
       </button>
       <button class="btn ghost" id="addRow">
        Add Row
       </button>
       <button class="btn ghost" id="clearRows">
        Clear All
       </button>
      </div>
     </div>
     <div class="table-container">
      <table id="otTable">
       <thead>
        <tr>
         <th style="width:160px">
          Date
         </th>
         <th style="width:110px">
          Start
         </th>
         <th style="width:110px">
          End
         </th>
         <th style="width:120px">
          Hours
         </th>
         <th style="width:160px">
          Multiplier
         </th>
         <th>
          OT Pay (RM)
         </th>
         <th style="width:auto">
          Notes
         </th>
         <th style="width:80px">
         </th>
        </tr>
       </thead>
       <tbody>
       </tbody>
       <tfoot>
        <tr>
         <td colspan="5" style="text-align:right; font-weight: 600">
          Total OT Pay
         </td>
         <td id="otTotal" style="color: var(--accent)">
          RM 0.00
         </td>
         <td colspan="2">
         </td>
        </tr>
       </tfoot>
      </table>
     </div>
    </div>
    <div class="card panel" style="margin-top: 24px">
     <h2 class="section-title" style="margin-bottom: 20px">
      üìä Breakdown
     </h2>
     <div class="table-container">
      <table>
       <tbody>
        <tr>
         <td class="muted">
          üíµ Basic
         </td>
         <td id="bBasic">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üìã Claims
         </td>
         <td id="bClaims">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üì± HP Allowance
         </td>
         <td id="bHP">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üéØ Incentive
         </td>
         <td id="bIncen">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          ‚è∞ OT Pay
         </td>
         <td id="bOT">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td style="font-weight: 600; color: var(--accent)">
          üí∞ Gross Total
         </td>
         <td id="bGross" style="font-weight: 600; color: var(--accent)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üè¶ EPF
         </td>
         <td id="bEPF" style="color: var(--warning)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üõ°Ô∏è SOCSO
         </td>
         <td id="bSOCSO" style="color: var(--warning)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üìä PCB
         </td>
         <td id="bPCB" style="color: var(--warning)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          ‚ö° EIS
         </td>
         <td id="bEIS" style="color: var(--warning)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üí∏ Cash Advance
         </td>
         <td id="bAdv" style="color: var(--warning)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td style="font-weight: 600; color: var(--warning)">
          üí∏ Total Deductions
         </td>
         <td id="bDeduct" style="font-weight: 600; color: var(--warning)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td style="font-weight: 700; color: var(--success)">
          ‚úÖ Net Pay
         </td>
         <td id="bNet" style="font-weight: 700; color: var(--success)">
          RM 0.00
         </td>
        </tr>
        <tr>
         <td class="muted">
          üìâ Total Expenses
         </td>
         <td id="bExpenses" style="color: var(--danger)">
          RM 0.00
         </td>
        </tr>
        <tr style="border-top: 2px solid var(--border-light);">
         <td style="font-weight: 700; font-size: 18px; color: var(--success)">
          üè¶ Remaining Balance
         </td>
         <td id="bBalance" style="font-weight: 700; font-size: 18px; color: var(--success)">
          RM 0.00
         </td>
        </tr>
       </tbody>
      </table>
     </div>
    </div>
   </div>
   <div class="tab-content" id="smart-tab">
    <div class="card panel">
     <h2 class="section-title" style="margin-bottom: 20px">
      ü§ñ Smart OT Calculator
     </h2>
     <div class="smart-form">
      <div class="form-section">
       <h4>
        üí∞ Basic Information
       </h4>
       <div class="form-row">
        <div>
         <label>
          Basic Salary (RM)
         </label>
         <input id="smartBasicSalary" placeholder="3700" step="0.01" type="number"/>
        </div>
        <div>
         <label>
          Date Range Start
         </label>
         <input id="startDate" type="text"/>
        </div>
        <div>
         <label>
          Date Range End
         </label>
         <input id="endDate" type="text"/>
        </div>
       </div>
       <div id="smartHourlyRateDisplay" style="background: rgba(80, 250, 123, 0.1); border: 1px solid rgba(80, 250, 123, 0.3); color: var(--success); padding: 12px; border-radius: var(--radius-sm); margin-top: 12px; text-align: center; font-weight: 600; display: none;">
       </div>
      </div>
      <div class="form-section">
       <h4>
        üèñÔ∏è Public Holidays (2025)
       </h4>
       <div class="holiday-checklist" id="holidayChecklist">
       </div>
       <div class="form-row" style="margin-top: 16px;">
        <div>
         <label>
          Add Custom Holiday
         </label>
         <div style="display: flex; gap: 8px;">
          <input id="holidayPicker" style="flex: 1;" type="text"/>
          <button class="btn success" onclick="addHoliday()" type="button">
           ‚ûï Add
          </button>
         </div>
        </div>
       </div>
       <div id="holidayList" style="margin-top: 12px;">
       </div>
      </div>
      <div class="form-section">
       <h4>
        ‚öôÔ∏è AI Schedule Constraints
       </h4>
       <div class="form-row">
        <div>
         <label>
          Unavailable / Blackout Dates
         </label>
         <input id="blackoutDates" placeholder="Select dates you cannot work..." type="text"/>
        </div>
        <div>
         <label>
          Work Style Preference
         </label>
         <select id="workStylePreference">
          <option value="balanced">
           Balanced (Default)
          </option>
          <option value="long_days">
           Prefer Fewer, Longer Days
          </option>
          <option value="short_sessions">
           Prefer More, Shorter Sessions
          </option>
         </select>
        </div>
       </div>
      </div>
      <div class="form-section">
       <h4>
        üìù OT Pattern Templates
       </h4>
       <div id="patternListContainer">
       </div>
       <div class="row" style="margin-top: 20px;">
        <button class="btn ghost" id="addCustomPatternBtn">
         ‚ûï Add New Custom Pattern
        </button>
       </div>
      </div>
     </div>
     <div class="form-section" style="margin-bottom: 24px;">
      <h4>
       üéØ Target-Based Calculator
      </h4>
      <div class="form-row">
       <div>
        <label>
         Target OT Pay (RM)
        </label>
        <input id="targetPay" placeholder="4000" step="0.01" type="number"/>
       </div>
      </div>
      <div class="row" style="justify-content: center; margin-top: 16px; gap: 16px;">
       <button class="btn primary" onclick="calculateSmartOT()" style="padding: 12px 24px; font-size: 16px;">
        ‚ú® Calculate to Target
       </button>
       <button class="btn success" onclick="aiSuggestSchedule()" style="padding: 12px 24px; font-size: 16px;">
        ü§ñ AI Suggest Schedule
       </button>
      </div>
     </div>
     <div id="smartResults" style="display: none;">
      <div class="results-summary" id="smartSummary">
      </div>
      <div class="form-section hour-adjuster-panel" id="smartHourAdjusterContainer" style="display: none;">
       <h4>
        üîß Fine-Tune Schedule
       </h4>
       <div class="fine-tune-progress-container" style="margin-bottom: 16px;">
        <div class="progress-bar-container">
         <div class="progress-bar-fill" id="fineTuneProgressBarFill">
         </div>
         <div class="progress-bar-text" id="fineTuneProgressBarText">
         </div>
        </div>
       </div>
       <div style="text-align: center; margin-bottom: 16px; font-size: 16px;">
        <span>
         Total OT Pay:
        </span>
        <strong id="smartTotalOtPayAdjuster" style="color: var(--accent); font-size: 18px;">
         RM 0.00
        </strong>
       </div>
       <div class="grid grid-4">
        <div class="adjuster-item">
         <label>
          Weekday (1.5x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustHours('weekday', -0.5)">
           -
          </button>
          <input id="manualWeekdayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustHours('weekday', 0.5)">
           +
          </button>
         </div>
        </div>
        <div class="adjuster-item">
         <label>
          Saturday (1.5x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustHours('saturday', -0.5)">
           -
          </button>
          <input id="manualSaturdayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustHours('saturday', 0.5)">
           +
          </button>
         </div>
        </div>
        <div class="adjuster-item">
         <label>
          Sunday (0.5x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustHours('sunday', -0.5)">
           -
          </button>
          <input id="manualSundayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustHours('sunday', 0.5)">
           +
          </button>
         </div>
        </div>
        <div class="adjuster-item">
         <label>
          Holiday (2.0x)
         </label>
         <div class="adjuster-controls">
          <button class="btn ghost" onclick="adjustHours('holiday', -0.5)">
           -
          </button>
          <input id="holidayHoursTotal" readonly="" type="text"/>
          <button class="btn ghost" onclick="adjustHours('holiday', 0.5)">
           +
          </button>
         </div>
        </div>
       </div>
      </div>
      <div class="form-section">
       <div class="split" style="margin-bottom: 16px;">
        <h4>
         üìã Generated OT Schedule
        </h4>
        <div class="row">
         <button class="btn success" onclick="exportToCSV()">
          üìÑ Export CSV
         </button>
         <button class="btn primary" onclick="exportToPDF()">
          üìë Export PDF
         </button>
         <button class="btn ghost" onclick="applyToManualTab()">
          üìä Apply to Manual Tab
         </button>
        </div>
       </div>
       <div class="table-container">
        <table id="smartOTTable">
         <thead>
          <tr>
           <th>
            Date
           </th>
           <th>
            Day
           </th>
           <th>
            OT Type
           </th>
           <th>
            Start
           </th>
           <th>
            End
           </th>
           <th>
            Hours
           </th>
           <th>
            Pay (RM)
           </th>
          </tr>
         </thead>
         <tbody>
         </tbody>
        </table>
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="tab-content" id="expenses-tab">
    <div class="expenses-grid">
     <div class="card panel">
      <div class="split" style="margin-bottom: 16px;">
       <h2 class="section-title">
        üí∏ Monthly Expenses (
        <span id="expensesMonthLabel">
        </span>
        )
       </h2>
       <div class="row">
        <button class="btn ghost" id="copyRecurringExpensesBtn">
         üìã Copy Recurring from Last Month
        </button>
        <button class="btn ghost" id="clearExpensesBtn">
         üóëÔ∏è Clear All
        </button>
       </div>
      </div>
      <input id="expenseSearch" placeholder="üîç Search expenses..." style="margin-bottom: 16px;" type="text"/>
      <div class="table-container" style="margin-top: 0;">
       <table id="expensesTable">
        <thead>
         <tr>
          <th data-sort="date">
           Date
          </th>
          <th data-sort="desc">
           Description
          </th>
          <th data-sort="category">
           Category
          </th>
          <th data-sort="isRecurring">
           Recurring
          </th>
          <th data-sort="fullAmount">
           Total Cost
          </th>
          <th data-sort="amount">
           My Cost
          </th>
          <th data-sort="partnerShare">
           Partner's Cost
          </th>
          <th>
           Notes
          </th>
          <th style="width: 120px;">
           Actions
          </th>
         </tr>
        </thead>
        <tbody>
        </tbody>
        <tfoot>
         <tr>
          <td colspan="5" style="text-align:right;">
           Totals
          </td>
          <td id="expensesMyTotal" style="color: var(--danger); font-weight: 700;">
           RM 0.00
          </td>
          <td id="expensesPartnerTotal" style="color: var(--accent); font-weight: 700;">
           RM 0.00
          </td>
          <td colspan="2">
          </td>
         </tr>
        </tfoot>
       </table>
      </div>
      <h3 class="section-title" style="margin-top: 32px; padding-top: 24px; border-top: 1px solid var(--border); font-size: 20px;">
       ‚ûï Add / Edit Expense
      </h3>
      <form id="addExpenseForm">
       <div class="form-row">
        <div>
         <label for="expenseDate">
          Date
         </label>
         <input id="expenseDate" required="" type="text"/>
        </div>
        <div>
         <label for="expenseDesc">
          Description
         </label>
         <input id="expenseDesc" placeholder="e.g., Groceries" required="" type="text"/>
        </div>
        <div>
         <label for="expenseCat">
          Category
         </label>
         <input id="expenseCat" list="expenseCategories" placeholder="e.g., Food" required="" type="text"/>
         <datalist id="expenseCategories">
          <option value="Food &amp; Dining">
          </option>
          <option value="Transportation">
          </option>
          <option value="Bills &amp; Utilities">
          </option>
          <option value="Housing">
          </option>
          <option value="Shopping">
          </option>
          <option value="Entertainment">
          </option>
          <option value="Health &amp; Fitness">
          </option>
          <option value="Personal Care">
          </option>
          <option value="Education">
          </option>
          <option value="Miscellaneous">
          </option>
         </datalist>
        </div>
       </div>
       <div class="form-row">
        <div>
         <label for="expenseTotalCost">
          Total Cost (RM)
         </label>
         <input id="expenseTotalCost" placeholder="100.00" step="0.01" type="number"/>
        </div>
        <div>
         <label>
          Split Rule
         </label>
         <div class="split-buttons-group">
          <button class="btn split-btn active" data-split="i-paid" type="button">
           I Paid 100%
          </button>
          <button class="btn split-btn" data-split="50-50" type="button">
           50 / 50
          </button>
          <button class="btn split-btn" data-split="p-paid" type="button">
           Partner Paid 100%
          </button>
         </div>
        </div>
       </div>
       <div class="form-row">
        <div style="flex-grow: 1;">
         <label for="expenseNotes">
          Notes (Optional)
         </label>
         <input id="expenseNotes" placeholder="e.g., Dinner with family" type="text"/>
        </div>
        <div class="form-actions" style="display: flex; flex-direction: column; gap: 8px;">
         <div class="toggle-group" style="margin-top: auto; margin-bottom: 8px;">
          <label class="switch">
           <input id="isRecurringToggle" type="checkbox"/>
           <span class="slider">
           </span>
          </label>
          <label class="toggle-label" for="isRecurringToggle" style="margin-bottom: 0;">
           Mark as Recurring
          </label>
         </div>
        </div>
       </div>
       <div class="form-row" style="margin-top: 16px;">
        <button class="btn primary" id="addExpenseBtn" style="flex: 1; height: 49px;" type="submit">
         ‚ûï Add
        </button>
        <button class="btn ghost" id="cancelEditBtn" style="display: none; height: 49px;" type="button">
         ‚ùå
        </button>
       </div>
       <input id="expenseMyShare" type="hidden"/>
       <input id="expensePartnerShare" type="hidden"/>
      </form>
     </div>
     <div class="card panel">
      <div class="split">
       <h2 class="section-title">
        üìä Expense Analysis
       </h2>
       <button class="btn ghost" id="setBudgetsBtn">
        üí∞ Set Budgets
       </button>
      </div>
      <div class="chart-container" style="height: 200px; margin-bottom: 24px;">
       <canvas id="expensePieChart">
       </canvas>
      </div>
      <div class="insights-container" id="spendingInsights">
       <h4 class="insights-title">
        üîç Spending Insights
       </h4>
       <div id="insightsList">
        <p class="muted" style="text-align:center;">
         No insights to show yet.
        </p>
       </div>
      </div>
      <div class="expense-analysis-container" id="expenseInfographicContainer">
      </div>
     </div>
    </div>
   </div>
   <div class="tab-content" id="forecast-tab">
    <div class="forecast-grid">
     <div class="card panel forecast-card">
      <h2 class="section-title" style="margin-bottom: 20px">
       üîÆ Predictive Forecast
      </h2>
      <p class="muted" style="margin-bottom: 24px;">
       Based on your average overtime from the last 3 months.
      </p>
      <div class="stat">
       <div class="label">
        Avg. OT Hours / Month
       </div>
       <div class="value" id="forecastAvgHours">
        0.0h
       </div>
      </div>
      <div class="stat">
       <div class="label">
        Projected Gross Pay
       </div>
       <div class="value" id="forecastGross">
        RM 0.00
       </div>
      </div>
      <div class="stat">
       <div class="label">
        Projected Deductions
       </div>
       <div class="value" id="forecastDeductions" style="color: var(--warning);">
        RM 0.00
       </div>
      </div>
      <div class="stat">
       <div class="label">
        Projected Net Pay
       </div>
       <div class="value" id="forecastNet" style="color: var(--success);">
        RM 0.00
       </div>
      </div>
     </div>
     <div class="card panel forecast-card">
      <h2 class="section-title" style="margin-bottom: 20px">
       ü§î "What-If" Analysis
      </h2>
      <p class="muted" style="margin-bottom: 24px;">
       See how additional OT hours could affect your current month's pay.
      </p>
      <div>
       <label for="whatIfSlider">
        Additional OT Hours (at 1.5x):
        <strong id="whatIfHoursLabel" style="color: var(--accent);">
         0.0h
        </strong>
       </label>
       <div class="what-if-slider-container">
        <input id="whatIfSlider" max="100" min="0" step="0.5" type="range" value="0"/>
       </div>
      </div>
      <div class="stat">
       <div class="label">
        "What-If" Gross Pay
       </div>
       <div class="value" id="whatIfGross">
        RM 0.00
       </div>
      </div>
      <div class="stat">
       <div class="label">
        "What-If" Deductions
       </div>
       <div class="value" id="whatIfDeductions" style="color: var(--warning);">
        RM 0.00
       </div>
      </div>
      <div class="stat">
       <div class="label">
        "What-If" Net Pay
       </div>
       <div class="value" id="whatIfNet" style="color: var(--success);">
        RM 0.00
       </div>
      </div>
     </div>
    </div>
   </div>
   <div class="footer-tip">
    <p class="muted small" style="margin: 0">
     üí°
     <strong>
      Tip:
     </strong>
     All data is saved in your browser's local storage.
    </p>
   </div>
  </div>
  <div class="modal-overlay" id="budgetModal">
   <div class="modal-content">
    <div class="modal-header">
     <h2 class="section-title">
      üí∞ Set Monthly Budgets
     </h2>
     <button class="modal-close-btn">
      √ó
     </button>
    </div>
    <div id="budgetForm">
    </div>
    <div class="row" style="margin-top: 28px; justify-content: flex-end">
     <button class="btn primary" id="saveBudgetsBtn">
      üíæ Save Budgets
     </button>
    </div>
   </div>
  </div>
  <div class="modal-overlay" id="annualSummaryModal">
   <div class="modal-content" style="max-width: 800px;">
    <div class="modal-header">
     <div style="display: flex; align-items: center; gap: 16px;">
      <h2 class="section-title">
       üóìÔ∏è Annual Summary
      </h2>
      <select id="annualSummaryYearSelect">
      </select>
     </div>
     <button class="modal-close-btn">
      √ó
     </button>
    </div>
    <div id="annualSummaryContent">
    </div>
   </div>
  </div>
  <div class="modal-overlay" id="payslipModal">
   <div class="modal-content" id="payslipContent" style="max-width: 800px;">
   </div>
  </div>
  <script src="js/main.js">
  </script>
 </body>
</html>